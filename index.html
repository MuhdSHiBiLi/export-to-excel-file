<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Export Multiple Rows to Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  </head>
  <body>
    <table id="dataTable" border="1">
      <thead>
        <tr role="row">
          <th
            colspan="1"
            class="sorting_disabled"
            rowspan="1"
            style="width: 45.05px"
          >
            Unit
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 45.3875px"
          >
            Ref. No.
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 25.9625px"
          >
            New
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 109.825px"
          >
            Name
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 59px"
          >
            Careoff
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 139.812px"
          >
            House Name
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 108.5px"
          >
            Place
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 48.5px"
          >
            Pincode
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 86.75px"
          >
            Post Office
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 75.5875px"
          >
            Mobile
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 261.413px"
          >
            Email
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 72.5625px"
          >
            Scheme
          </th>
          <th
            class="sorting_disabled"
            rowspan="1"
            colspan="1"
            style="width: 52.125px"
          >
            Duration
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556039</td>
          <td>YES</td>
          <td>MUNAWIR MV</td>
          <td></td>
          <td>AKKAPARAMB M V H S STORE</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9496554089</td>
          <td></td>
          <td>Print</td>
          <td>6 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556038</td>
          <td>NO</td>
          <td>CHANDRAN MASH</td>
          <td></td>
          <td>AKKAPARAMBA</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>7025237551</td>
          <td></td>
          <td>Print</td>
          <td>6 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556036</td>
          <td>YES</td>
          <td>VAYANASHAALA AKP PULIYAKD</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>PULIYAKKODE SCHOOL PADI</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9846099861</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556028</td>
          <td>YES</td>
          <td>KABEER PUNIYAANIKKODAN</td>
          <td></td>
          <td>AKKAPARAMBA SCHOOL PADI</td>
          <td>IDHINJARAKKUNDIL HOUSE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>8078007030</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556027</td>
          <td>YES</td>
          <td>MUHAMMED AQIL MUSLIYAR PK</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>PUNIYANIKKODAN HOUSE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9633108125</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556026</td>
          <td>NO</td>
          <td>MUKKUDAN ABDU SALAAM</td>
          <td></td>
          <td>AKKAPARAMBA TURF ROAD</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9947064879</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556024</td>
          <td>NO</td>
          <td>ADIL TK</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>SCHOOL PADI PULIYAKKODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>7356356983</td>
          <td>TKADIL007@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556022</td>
          <td>NO</td>
          <td>RAMEEZ NUHMAN P</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>SCHOOL PADI PULIYAKKODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9539305840</td>
          <td>RAMEEZ2005@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556018</td>
          <td>YES</td>
          <td>MAMMED KURUTHODI</td>
          <td></td>
          <td>AKKAPARAMBA COLONY ROAD</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9745896496</td>
          <td>NSAKKEENA833@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556014</td>
          <td>YES</td>
          <td>MUHAMMED NIDAL PK</td>
          <td></td>
          <td>PUNIYANIKKODAN HOUSE</td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>8078229533</td>
          <td>NIDALPK91@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>556006</td>
          <td>NO</td>
          <td>SABEEH MUHAMMED M P</td>
          <td></td>
          <td>AKKAPARAMBA HOUSE</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>8606354760</td>
          <td>SABEEHMUHAMMEDMP9744@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>556002</td>
          <td>NO</td>
          <td>MUHAMMED FAYIZ TK</td>
          <td></td>
          <td>PULIYAKKODE SCHOOL PADI</td>
          <td>PULIYAKKOCDE AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9995333412</td>
          <td>MUHAMMEDFAYIZTK@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>555997</td>
          <td>NO</td>
          <td>MUHAMMED SHAFEEQUE K</td>
          <td></td>
          <td>PULIYAKKODE SCHOOL PADI</td>
          <td>AKKAPARAMBA P O</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>8138893547</td>
          <td>SHAFEEQPKD19@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>550428</td>
          <td>NO</td>
          <td>ABDUL FATHAH MC</td>
          <td></td>
          <td>AKKAPARAMBA SCHOOL PADI</td>
          <td>PULIYAKKODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9747453494</td>
          <td>AFMPULIYAKODE@GMAIL.COM</td>
          <td>Print+Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>550422</td>
          <td>YES</td>
          <td>MUHAMMAD MUSTHAFA M</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>7034539298</td>
          <td>MUSTHAFAMALAYAN@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>550417</td>
          <td>NO</td>
          <td>MUHAMMED SHAMIL T K</td>
          <td></td>
          <td>AKKAPARAMBA PULIYAKKODE</td>
          <td>PULIYAKKODE SCHOOL PADI</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9495338173</td>
          <td>TKMSHAMIL@GMAIL.COM</td>
          <td>Print+Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>550409</td>
          <td>NO</td>
          <td>MUHAMMED SINAN K</td>
          <td></td>
          <td>PULIYAKKODE</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9072559951</td>
          <td>MUHAMMEDSINANPULIYAKKODE@GMAIL.COM</td>
          <td>Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>549949</td>
          <td>NO</td>
          <td>AUP SCHOOL PULIYAKKODE</td>
          <td></td>
          <td>AKKAPARAMBA PO PULIYAKODE</td>
          <td>PULIYAKKODE SCHOOL</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9497467354</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>536031</td>
          <td>NO</td>
          <td>SAYYID MUHAMMED ARSHAD</td>
          <td></td>
          <td>AKKAPARAMBA HOUSE</td>
          <td>AKKAPARAMBA MELMURI RODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9961717884</td>
          <td>SAYYIDARSHADSHAN@GMAIL.COM</td>
          <td>Print+Digital</td>
          <td>12 Months</td>
        </tr>
        <tr class="even">
          <td>Akkaparamba</td>
          <td>536029</td>
          <td>NO</td>
          <td>KAMMUKKUTTY HAJI</td>
          <td></td>
          <td>NEERUTTICHALIL</td>
          <td>AKKAPARAMBA</td>
          <td>673641</td>
          <td>AKKAPARAMBA B.O</td>
          <td>9605313664</td>
          <td></td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
        <tr class="odd">
          <td>Akkaparamba</td>
          <td>534733</td>
          <td>NO</td>
          <td>MUHAMMED SHIBILI M</td>
          <td>SAIDALAVI M</td>
          <td>PARAMBATTUKAVUNGAL HOUSE</td>
          <td>PULIYAKKODE</td>
          <td>673641</td>
          <td>AKKAPARAMBA</td>
          <td>9061969167</td>
          <td>MUHAMMEDSHIBILI.M786@GMAIL.COM</td>
          <td>Print</td>
          <td>12 Months</td>
        </tr>
      </tbody>
    </table>
    <button onclick="exportToExcel()">Export to Excel</button>

    <script>
      function exportToExcel() {
        let table = document.getElementById("dataTable");
        let rows = table.getElementsByTagName("tr");
        let data = [];

        // Process header row separately to get the correct headers
        let headerRow = rows[0];
        let headerCells = headerRow.getElementsByTagName("th");
        let headers = [];

        for (let i = 0; i < headerCells.length; i++) {
          headers.push(headerCells[i].textContent.trim());
        }

        data.push(headers); // Add headers as first row in Excel

        // Process data rows (skip header row)
        for (let i = 1; i < rows.length; i++) {
          let cells = rows[i].getElementsByTagName("td");
          let rowData = [];

          for (let j = 0; j < cells.length; j++) {
            rowData.push(cells[j].textContent.trim());
          }

          if (rowData.length > 0) {
            // Only add non-empty rows
            data.push(rowData);
          }
        }

        // Convert to Excel format
        let ws = XLSX.utils.aoa_to_sheet(data);
        let wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

        // Save the file
        XLSX.writeFile(wb, "March_payment.xlsx"); //name of the sheet which name the file as saved
      }
    </script>
  </body>
</html>
